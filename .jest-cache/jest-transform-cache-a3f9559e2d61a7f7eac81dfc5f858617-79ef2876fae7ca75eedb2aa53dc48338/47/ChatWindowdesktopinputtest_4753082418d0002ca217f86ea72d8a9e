b9337fb2753589f52950879d51bbad57
"use strict";
// Mock next/dynamic to avoid loading heavy components during tests
jest.mock("next/dynamic", ()=>()=>(props)=>null);
// Mock Next.js navigation to satisfy components that call useRouter/usePathname
jest.mock("next/navigation", ()=>({
        useRouter: ()=>({
                push: jest.fn(),
                replace: jest.fn(),
                prefetch: jest.fn(),
                back: jest.fn()
            }),
        usePathname: ()=>"/messages",
        useSearchParams: ()=>({
                get: ()=>null
            })
    }));
// Force credits UI on and a known per-request estimate
jest.mock("@/lib/pricing", ()=>({
        CREDITS_ENABLED: true,
        CREDITS_PER_AI_REQUEST: 2
    }));
// Mock credits service to avoid network and provide stable balance
jest.mock("@/services/credit-service", ()=>({
        getCreditBalance: jest.fn(async ()=>({
                balance: 42
            }))
    }));
// Mock conversations hook
jest.mock("@/hooks/use-conversations", ()=>({
        useConversations: ()=>({
                conversations: [
                    {
                        id: "abc",
                        title: "Test Conversation",
                        created_at: "",
                        updated_at: "",
                        user_id: "user-1"
                    }
                ],
                loading: false,
                error: null,
                inviteParticipants: jest.fn()
            })
    }));
jest.mock("@/hooks/use-mobile", ()=>({
        useIsMobile: ()=>mockUseIsMobile()
    }));
jest.mock("@/hooks/use-websocket", ()=>({
        useWebSocket: ()=>({
                isConnected: true,
                messages: [],
                typingUsers: {},
                joinConversation: jest.fn(),
                sendChatMessage,
                sendTyping: jest.fn(),
                sendEditMessage
            })
    }));
// Supabase client mock: auth.getUser and participant count query
jest.mock("@/lib/supabase/client", ()=>{
    const supabase = {
        auth: {
            getUser: async ()=>({
                    data: {
                        user: {
                            id: "me"
                        }
                    }
                })
        },
        from: (_table)=>({
                select: (_sel, _opts)=>({
                        eq: (_col, _val)=>Promise.resolve({
                                count: 1
                            })
                    })
            })
    };
    return {
        supabase
    };
});
// Mock message-bubble to expose a test-only Edit action triggering ChatWindow.onUpdateMessage
jest.mock("@/components/chat/message-bubble", ()=>({
        MessageBubble: ({ message, onUpdateMessage })=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        "data-testid": `msg-${message.id}`,
                        children: message.content
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                        onClick: ()=>onUpdateMessage(message.id, "Hello edited"),
                        children: "Edit"
                    })
                ]
            })
    }));
jest.mock("@/services/message-service", ()=>({
        messageService: {
            getMessages: (...args)=>getMessagesMock(...args),
            updateMessage: (...args)=>updateMessageMock(...args)
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _react1 = require("@testing-library/react");
const _testutils = require("../utils/test-utils");
const _chatwindow = require("../../components/chat/chat-window");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Prepare a controllable mobile hook
const mockUseIsMobile = jest.fn(()=>false);
// WebSocket hook mock with spies
const sendChatMessage = jest.fn();
const sendEditMessage = jest.fn();
// Controllable message service mock
const getMessagesMock = jest.fn();
const updateMessageMock = jest.fn();
const baseProps = {
    chatId: "abc",
    onToggleSidebar: ()=>{},
    sidebarCollapsed: false
};
beforeEach(()=>{
    jest.clearAllMocks();
    mockUseIsMobile.mockReturnValue(false);
    // Default: resolve quickly with one message
    getMessagesMock.mockResolvedValue([
        {
            id: "m1",
            conversation_id: "abc",
            user_id: "me",
            content: "Original message",
            created_at: new Date().toISOString(),
            role: "user",
            type: "text",
            edited_at: null
        }
    ]);
    updateMessageMock.mockResolvedValue({});
});
describe("ChatWindow + DesktopMessageInput integration", ()=>{
    test("renders DesktopMessageInput on desktop (Message input present)", async ()=>{
        mockUseIsMobile.mockReturnValue(false);
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Desktop textarea is labeled
        expect(await _react1.screen.findByLabelText(/message input/i)).toBeInTheDocument();
    });
    test("does not render Desktop aria-labeled input on mobile", async ()=>{
        jest.clearAllMocks();
        mockUseIsMobile.mockReturnValue(true);
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Mobile textarea has no aria-label "Message input"
        await (0, _react1.waitFor)(()=>{
            expect(_react1.screen.queryByLabelText(/message input/i)).not.toBeInTheDocument();
        });
    });
    test("keyboard shortcuts: Enter sends, Shift+Enter does not, Ctrl+Enter sends", async ()=>{
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        const input = await _react1.screen.findByLabelText(/message input/i);
        // Type something
        _react1.fireEvent.change(input, {
            target: {
                value: "Hello"
            }
        });
        // Enter sends
        _react1.fireEvent.keyDown(input, {
            key: "Enter",
            code: "Enter"
        });
        expect(sendChatMessage).toHaveBeenCalledTimes(1);
        // Type again
        _react1.fireEvent.change(input, {
            target: {
                value: "Hello again"
            }
        });
        // Shift+Enter should not send
        _react1.fireEvent.keyDown(input, {
            key: "Enter",
            code: "Enter",
            shiftKey: true
        });
        expect(sendChatMessage).toHaveBeenCalledTimes(1);
        // Ctrl+Enter sends
        _react1.fireEvent.keyDown(input, {
            key: "Enter",
            code: "Enter",
            ctrlKey: true
        });
        expect(sendChatMessage).toHaveBeenCalledTimes(2);
    });
    test("credit usage UI: shows CreditBadge, BuyCreditsButton and estimate text", async ()=>{
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Credit estimate
        expect(await _react1.screen.findByText(/est\. credits:\s*2/i)).toBeInTheDocument();
        // Buy Credits button
        expect(_react1.screen.getByRole("button", {
            name: /buy credits/i
        })).toBeInTheDocument();
        // Credit balance badge (42) - use more specific selector for mocked component
        expect(_react1.screen.getByTestId("credits-popover-mock")).toBeInTheDocument();
    });
    test("AI mode toggle updates badge and placeholder", async ()=>{
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        const input = await _react1.screen.findByLabelText(/message input/i);
        // Initial placeholder
        expect(input.placeholder).toMatch(/type a message/i);
        const toggle = _react1.screen.getByRole("button", {
            name: /enable ai mode/i
        });
        _react1.fireEvent.click(toggle);
        // After enabling
        expect(_react1.screen.getByText(/ai mode/i)).toBeInTheDocument();
        expect(_react1.screen.getByRole("button", {
            name: /disable ai mode/i
        })).toBeInTheDocument();
        expect(input.placeholder).toMatch(/ask ai or type a message/i);
    });
    test("inline edit: optimistic update, persistence, and WS broadcast", async ()=>{
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Original content visible
        const original = await _react1.screen.findByTestId("msg-m1");
        expect(original).toHaveTextContent("Original message");
        // Trigger our test-only Edit button in mocked MessageBubble
        _react1.fireEvent.click(_react1.screen.getByText("Edit"));
        // Optimistic content change should be immediate
        expect(_react1.screen.getByTestId("msg-m1")).toHaveTextContent("Hello edited");
        // Persistence and broadcast
        await (0, _react1.waitFor)(()=>{
            expect(updateMessageMock).toHaveBeenCalledWith("m1", "Hello edited");
            expect(sendEditMessage).toHaveBeenCalledWith("m1", "Hello edited", "abc");
        });
    });
    test("inline edit failure: reverts to previous content", async ()=>{
        updateMessageMock.mockRejectedValueOnce(new Error("DB down"));
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Original content visible
        expect(await _react1.screen.findByTestId("msg-m1")).toHaveTextContent("Original message");
        // Trigger edit
        _react1.fireEvent.click(_react1.screen.getByText("Edit"));
        // Optimistic change first
        expect(_react1.screen.getByTestId("msg-m1")).toHaveTextContent("Hello edited");
        // Then revert after failure
        await (0, _react1.waitFor)(()=>{
            expect(_react1.screen.getByTestId("msg-m1")).toHaveTextContent("Original message");
        });
    });
    test("skeleton loader shows while loading, then empty state when no messages", async ()=>{
        // Delay messages to assert skeletons
        getMessagesMock.mockImplementationOnce(()=>new Promise((resolve)=>setTimeout(()=>resolve([]), 50)));
        const { container } = await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Skeletons present during load
        expect(container.querySelectorAll('[data-slot="skeleton"]').length).toBeGreaterThan(0);
        // After load completes, skeletons go away and empty state shows
        await (0, _react1.waitFor)(()=>{
            expect(container.querySelectorAll('[data-slot="skeleton"]').length).toBe(0);
            expect(_react1.screen.getByText(/no messages yet\. say hello!/i)).toBeInTheDocument();
        });
    });
    test("action panel opens and tabs switch on desktop", async ()=>{
        await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Open the action panel via the + button
        const openActions = await _react1.screen.findByRole("button", {
            name: /open actions/i
        });
        _react1.fireEvent.click(openActions);
        // Default tab is Media
        expect(await _react1.screen.findByText(/media & content/i)).toBeInTheDocument();
        // Switch to Apps
        _react1.fireEvent.click(_react1.screen.getByRole("button", {
            name: /apps/i
        }));
        expect(await _react1.screen.findByText(/quick apps/i)).toBeInTheDocument();
        // Switch to Agents
        _react1.fireEvent.click(_react1.screen.getByRole("button", {
            name: /agents/i
        }));
        expect(await _react1.screen.findByText(/ai agents/i)).toBeInTheDocument();
    });
    test("selecting a GIF appends a new message on desktop", async ()=>{
        jest.useFakeTimers();
        const { container } = await (0, _testutils.renderWithAct)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_chatwindow.ChatWindow, {
            ...baseProps
        }));
        // Start with a single message from the backend
        await _react1.screen.findByTestId("msg-m1");
        expect(container.querySelectorAll('[data-testid^="msg-"]').length).toBe(1);
        // Open action panel
        _react1.fireEvent.click(await _react1.screen.findByRole("button", {
            name: /open actions/i
        }));
        expect(await _react1.screen.findByText(/media & content/i)).toBeInTheDocument();
        // Open GIF picker
        _react1.fireEvent.click(_react1.screen.getByRole("button", {
            name: /open gif picker/i
        }));
        // Wait for GIFs to load
        await _react1.screen.findByPlaceholderText(/search gifs/i);
        await _react1.screen.findByText(/loading gifs/i);
        await (0, _react1.act)(async ()=>{
            jest.advanceTimersByTime(600);
        });
        // Click a GIF
        const gifButton = await _react1.screen.findByTitle("Happy Dance");
        _react1.fireEvent.click(gifButton);
        // Message count should increase
        await (0, _react1.waitFor)(()=>{
            expect(container.querySelectorAll('[data-testid^="msg-"]').length).toBe(2);
        });
        jest.useRealTimers();
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9lbGljaGFybGVzZS9DYXNjYWRlUHJvamVjdHMvQUdFTlQvX190ZXN0c19fL2NvbXBvbmVudHMvQ2hhdFdpbmRvdy5kZXNrdG9wLWlucHV0LnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yLCBhY3QgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0J1xuaW1wb3J0IHsgcmVuZGVyV2l0aEFjdCB9IGZyb20gJy4uL3V0aWxzL3Rlc3QtdXRpbHMnXG5cbi8vIE1vY2sgbmV4dC9keW5hbWljIHRvIGF2b2lkIGxvYWRpbmcgaGVhdnkgY29tcG9uZW50cyBkdXJpbmcgdGVzdHNcbmplc3QubW9jaygnbmV4dC9keW5hbWljJywgKCkgPT4gKCkgPT4gKHByb3BzOiBhbnkpID0+IG51bGwpXG5cbi8vIE1vY2sgTmV4dC5qcyBuYXZpZ2F0aW9uIHRvIHNhdGlzZnkgY29tcG9uZW50cyB0aGF0IGNhbGwgdXNlUm91dGVyL3VzZVBhdGhuYW1lXG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XG4gIHVzZVJvdXRlcjogKCkgPT4gKHsgcHVzaDogamVzdC5mbigpLCByZXBsYWNlOiBqZXN0LmZuKCksIHByZWZldGNoOiBqZXN0LmZuKCksIGJhY2s6IGplc3QuZm4oKSB9KSxcbiAgdXNlUGF0aG5hbWU6ICgpID0+ICcvbWVzc2FnZXMnLFxuICB1c2VTZWFyY2hQYXJhbXM6ICgpID0+ICh7IGdldDogKCkgPT4gbnVsbCB9KSxcbn0pKVxuXG4vLyBGb3JjZSBjcmVkaXRzIFVJIG9uIGFuZCBhIGtub3duIHBlci1yZXF1ZXN0IGVzdGltYXRlXG5qZXN0Lm1vY2soJ0AvbGliL3ByaWNpbmcnLCAoKSA9PiAoe1xuICBDUkVESVRTX0VOQUJMRUQ6IHRydWUsXG4gIENSRURJVFNfUEVSX0FJX1JFUVVFU1Q6IDIsXG59KSlcblxuLy8gTW9jayBjcmVkaXRzIHNlcnZpY2UgdG8gYXZvaWQgbmV0d29yayBhbmQgcHJvdmlkZSBzdGFibGUgYmFsYW5jZVxuamVzdC5tb2NrKCdAL3NlcnZpY2VzL2NyZWRpdC1zZXJ2aWNlJywgKCkgPT4gKHtcbiAgZ2V0Q3JlZGl0QmFsYW5jZTogamVzdC5mbihhc3luYyAoKSA9PiAoeyBiYWxhbmNlOiA0MiB9KSksXG59KSlcblxuLy8gTW9jayBjb252ZXJzYXRpb25zIGhvb2tcbmplc3QubW9jaygnQC9ob29rcy91c2UtY29udmVyc2F0aW9ucycsICgpID0+ICh7XG4gIHVzZUNvbnZlcnNhdGlvbnM6ICgpID0+ICh7XG4gICAgY29udmVyc2F0aW9uczogW1xuICAgICAgeyBpZDogJ2FiYycsIHRpdGxlOiAnVGVzdCBDb252ZXJzYXRpb24nLCBjcmVhdGVkX2F0OiAnJywgdXBkYXRlZF9hdDogJycsIHVzZXJfaWQ6ICd1c2VyLTEnIH0sXG4gICAgXSxcbiAgICBsb2FkaW5nOiBmYWxzZSxcbiAgICBlcnJvcjogbnVsbCxcbiAgICBpbnZpdGVQYXJ0aWNpcGFudHM6IGplc3QuZm4oKSxcbiAgfSksXG59KSlcblxuLy8gUHJlcGFyZSBhIGNvbnRyb2xsYWJsZSBtb2JpbGUgaG9va1xuY29uc3QgbW9ja1VzZUlzTW9iaWxlID0gamVzdC5mbigoKSA9PiBmYWxzZSlcbmplc3QubW9jaygnQC9ob29rcy91c2UtbW9iaWxlJywgKCkgPT4gKHsgdXNlSXNNb2JpbGU6ICgpID0+IG1vY2tVc2VJc01vYmlsZSgpIH0pKVxuXG4vLyBXZWJTb2NrZXQgaG9vayBtb2NrIHdpdGggc3BpZXNcbmNvbnN0IHNlbmRDaGF0TWVzc2FnZSA9IGplc3QuZm4oKVxuY29uc3Qgc2VuZEVkaXRNZXNzYWdlID0gamVzdC5mbigpXG5qZXN0Lm1vY2soJ0AvaG9va3MvdXNlLXdlYnNvY2tldCcsICgpID0+ICh7XG4gIHVzZVdlYlNvY2tldDogKCkgPT4gKHtcbiAgICBpc0Nvbm5lY3RlZDogdHJ1ZSxcbiAgICBtZXNzYWdlczogW10sXG4gICAgdHlwaW5nVXNlcnM6IHt9LFxuICAgIGpvaW5Db252ZXJzYXRpb246IGplc3QuZm4oKSxcbiAgICBzZW5kQ2hhdE1lc3NhZ2UsXG4gICAgc2VuZFR5cGluZzogamVzdC5mbigpLFxuICAgIHNlbmRFZGl0TWVzc2FnZSxcbiAgfSksXG59KSlcblxuLy8gU3VwYWJhc2UgY2xpZW50IG1vY2s6IGF1dGguZ2V0VXNlciBhbmQgcGFydGljaXBhbnQgY291bnQgcXVlcnlcbmplc3QubW9jaygnQC9saWIvc3VwYWJhc2UvY2xpZW50JywgKCkgPT4ge1xuICBjb25zdCBzdXBhYmFzZSA9IHtcbiAgICBhdXRoOiB7XG4gICAgICBnZXRVc2VyOiBhc3luYyAoKSA9PiAoeyBkYXRhOiB7IHVzZXI6IHsgaWQ6ICdtZScgfSB9IH0pLFxuICAgIH0sXG4gICAgZnJvbTogKF90YWJsZTogc3RyaW5nKSA9PiAoe1xuICAgICAgc2VsZWN0OiAoX3NlbDogc3RyaW5nLCBfb3B0cz86IGFueSkgPT4gKHtcbiAgICAgICAgZXE6IChfY29sOiBzdHJpbmcsIF92YWw6IHN0cmluZykgPT4gUHJvbWlzZS5yZXNvbHZlKHsgY291bnQ6IDEgfSksXG4gICAgICB9KSxcbiAgICB9KSxcbiAgfVxuICByZXR1cm4geyBzdXBhYmFzZSB9XG59KVxuXG4vLyBNb2NrIG1lc3NhZ2UtYnViYmxlIHRvIGV4cG9zZSBhIHRlc3Qtb25seSBFZGl0IGFjdGlvbiB0cmlnZ2VyaW5nIENoYXRXaW5kb3cub25VcGRhdGVNZXNzYWdlXG5qZXN0Lm1vY2soJ0AvY29tcG9uZW50cy9jaGF0L21lc3NhZ2UtYnViYmxlJywgKCkgPT4gKHtcbiAgTWVzc2FnZUJ1YmJsZTogKHsgbWVzc2FnZSwgb25VcGRhdGVNZXNzYWdlIH06IGFueSkgPT4gKFxuICAgIDxkaXY+XG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPXtgbXNnLSR7bWVzc2FnZS5pZH1gfT57bWVzc2FnZS5jb250ZW50fTwvZGl2PlxuICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiBvblVwZGF0ZU1lc3NhZ2UobWVzc2FnZS5pZCwgJ0hlbGxvIGVkaXRlZCcpfT5FZGl0PC9idXR0b24+XG4gICAgPC9kaXY+XG4gICksXG59KSlcblxuLy8gQ29udHJvbGxhYmxlIG1lc3NhZ2Ugc2VydmljZSBtb2NrXG5jb25zdCBnZXRNZXNzYWdlc01vY2sgPSBqZXN0LmZuKClcbmNvbnN0IHVwZGF0ZU1lc3NhZ2VNb2NrID0gamVzdC5mbigpXG5qZXN0Lm1vY2soJ0Avc2VydmljZXMvbWVzc2FnZS1zZXJ2aWNlJywgKCkgPT4gKHtcbiAgbWVzc2FnZVNlcnZpY2U6IHtcbiAgICBnZXRNZXNzYWdlczogKC4uLmFyZ3M6IGFueVtdKSA9PiBnZXRNZXNzYWdlc01vY2soLi4uYXJncyksXG4gICAgdXBkYXRlTWVzc2FnZTogKC4uLmFyZ3M6IGFueVtdKSA9PiB1cGRhdGVNZXNzYWdlTW9jayguLi5hcmdzKSxcbiAgfSxcbn0pKVxuXG5pbXBvcnQgeyBDaGF0V2luZG93IH0gZnJvbSAnQC9jb21wb25lbnRzL2NoYXQvY2hhdC13aW5kb3cnXG5cbmNvbnN0IGJhc2VQcm9wcyA9IHtcbiAgY2hhdElkOiAnYWJjJyxcbiAgb25Ub2dnbGVTaWRlYmFyOiAoKSA9PiB7fSxcbiAgc2lkZWJhckNvbGxhcHNlZDogZmFsc2UsXG59XG5cbmJlZm9yZUVhY2goKCkgPT4ge1xuICBqZXN0LmNsZWFyQWxsTW9ja3MoKVxuICBtb2NrVXNlSXNNb2JpbGUubW9ja1JldHVyblZhbHVlKGZhbHNlKVxuICAvLyBEZWZhdWx0OiByZXNvbHZlIHF1aWNrbHkgd2l0aCBvbmUgbWVzc2FnZVxuICBnZXRNZXNzYWdlc01vY2subW9ja1Jlc29sdmVkVmFsdWUoW1xuICAgIHtcbiAgICAgIGlkOiAnbTEnLFxuICAgICAgY29udmVyc2F0aW9uX2lkOiAnYWJjJyxcbiAgICAgIHVzZXJfaWQ6ICdtZScsXG4gICAgICBjb250ZW50OiAnT3JpZ2luYWwgbWVzc2FnZScsXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICByb2xlOiAndXNlcicsXG4gICAgICB0eXBlOiAndGV4dCcsXG4gICAgICBlZGl0ZWRfYXQ6IG51bGwsXG4gICAgfSxcbiAgXSlcbiAgdXBkYXRlTWVzc2FnZU1vY2subW9ja1Jlc29sdmVkVmFsdWUoe30pXG59KVxuXG5kZXNjcmliZSgnQ2hhdFdpbmRvdyArIERlc2t0b3BNZXNzYWdlSW5wdXQgaW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gIHRlc3QoJ3JlbmRlcnMgRGVza3RvcE1lc3NhZ2VJbnB1dCBvbiBkZXNrdG9wIChNZXNzYWdlIGlucHV0IHByZXNlbnQpJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tVc2VJc01vYmlsZS5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpXG4gICAgYXdhaXQgcmVuZGVyV2l0aEFjdCg8Q2hhdFdpbmRvdyB7Li4uYmFzZVByb3BzfSAvPilcblxuICAgIC8vIERlc2t0b3AgdGV4dGFyZWEgaXMgbGFiZWxlZFxuICAgIGV4cGVjdChhd2FpdCBzY3JlZW4uZmluZEJ5TGFiZWxUZXh0KC9tZXNzYWdlIGlucHV0L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpXG4gIH0pXG5cbiAgdGVzdCgnZG9lcyBub3QgcmVuZGVyIERlc2t0b3AgYXJpYS1sYWJlbGVkIGlucHV0IG9uIG1vYmlsZScsIGFzeW5jICgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKVxuICAgIG1vY2tVc2VJc01vYmlsZS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSlcbiAgICBhd2FpdCByZW5kZXJXaXRoQWN0KDxDaGF0V2luZG93IHsuLi5iYXNlUHJvcHN9IC8+KVxuXG4gICAgLy8gTW9iaWxlIHRleHRhcmVhIGhhcyBubyBhcmlhLWxhYmVsIFwiTWVzc2FnZSBpbnB1dFwiXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoL21lc3NhZ2UgaW5wdXQvaSkpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpXG4gICAgfSlcbiAgfSlcblxuICB0ZXN0KCdrZXlib2FyZCBzaG9ydGN1dHM6IEVudGVyIHNlbmRzLCBTaGlmdCtFbnRlciBkb2VzIG5vdCwgQ3RybCtFbnRlciBzZW5kcycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCByZW5kZXJXaXRoQWN0KDxDaGF0V2luZG93IHsuLi5iYXNlUHJvcHN9IC8+KVxuICAgIGNvbnN0IGlucHV0ID0gYXdhaXQgc2NyZWVuLmZpbmRCeUxhYmVsVGV4dCgvbWVzc2FnZSBpbnB1dC9pKVxuXG4gICAgLy8gVHlwZSBzb21ldGhpbmdcbiAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ0hlbGxvJyB9IH0pXG5cbiAgICAvLyBFbnRlciBzZW5kc1xuICAgIGZpcmVFdmVudC5rZXlEb3duKGlucHV0LCB7IGtleTogJ0VudGVyJywgY29kZTogJ0VudGVyJyB9KVxuICAgIGV4cGVjdChzZW5kQ2hhdE1lc3NhZ2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKVxuXG4gICAgLy8gVHlwZSBhZ2FpblxuICAgIGZpcmVFdmVudC5jaGFuZ2UoaW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnSGVsbG8gYWdhaW4nIH0gfSlcblxuICAgIC8vIFNoaWZ0K0VudGVyIHNob3VsZCBub3Qgc2VuZFxuICAgIGZpcmVFdmVudC5rZXlEb3duKGlucHV0LCB7IGtleTogJ0VudGVyJywgY29kZTogJ0VudGVyJywgc2hpZnRLZXk6IHRydWUgfSlcbiAgICBleHBlY3Qoc2VuZENoYXRNZXNzYWdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSlcblxuICAgIC8vIEN0cmwrRW50ZXIgc2VuZHNcbiAgICBmaXJlRXZlbnQua2V5RG93bihpbnB1dCwgeyBrZXk6ICdFbnRlcicsIGNvZGU6ICdFbnRlcicsIGN0cmxLZXk6IHRydWUgfSlcbiAgICBleHBlY3Qoc2VuZENoYXRNZXNzYWdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMilcbiAgfSlcblxuICB0ZXN0KCdjcmVkaXQgdXNhZ2UgVUk6IHNob3dzIENyZWRpdEJhZGdlLCBCdXlDcmVkaXRzQnV0dG9uIGFuZCBlc3RpbWF0ZSB0ZXh0JywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHJlbmRlcldpdGhBY3QoPENoYXRXaW5kb3cgey4uLmJhc2VQcm9wc30gLz4pXG5cbiAgICAvLyBDcmVkaXQgZXN0aW1hdGVcbiAgICBleHBlY3QoYXdhaXQgc2NyZWVuLmZpbmRCeVRleHQoL2VzdFxcLiBjcmVkaXRzOlxccyoyL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpXG5cbiAgICAvLyBCdXkgQ3JlZGl0cyBidXR0b25cbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvYnV5IGNyZWRpdHMvaSB9KSkudG9CZUluVGhlRG9jdW1lbnQoKVxuXG4gICAgLy8gQ3JlZGl0IGJhbGFuY2UgYmFkZ2UgKDQyKSAtIHVzZSBtb3JlIHNwZWNpZmljIHNlbGVjdG9yIGZvciBtb2NrZWQgY29tcG9uZW50XG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnY3JlZGl0cy1wb3BvdmVyLW1vY2snKSkudG9CZUluVGhlRG9jdW1lbnQoKVxuICB9KVxuXG4gIHRlc3QoJ0FJIG1vZGUgdG9nZ2xlIHVwZGF0ZXMgYmFkZ2UgYW5kIHBsYWNlaG9sZGVyJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHJlbmRlcldpdGhBY3QoPENoYXRXaW5kb3cgey4uLmJhc2VQcm9wc30gLz4pXG4gICAgY29uc3QgaW5wdXQgPSBhd2FpdCBzY3JlZW4uZmluZEJ5TGFiZWxUZXh0KC9tZXNzYWdlIGlucHV0L2kpXG5cbiAgICAvLyBJbml0aWFsIHBsYWNlaG9sZGVyXG4gICAgZXhwZWN0KChpbnB1dCBhcyBIVE1MVGV4dEFyZWFFbGVtZW50KS5wbGFjZWhvbGRlcikudG9NYXRjaCgvdHlwZSBhIG1lc3NhZ2UvaSlcblxuICAgIGNvbnN0IHRvZ2dsZSA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2VuYWJsZSBhaSBtb2RlL2kgfSlcbiAgICBmaXJlRXZlbnQuY2xpY2sodG9nZ2xlKVxuXG4gICAgLy8gQWZ0ZXIgZW5hYmxpbmdcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvYWkgbW9kZS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKVxuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9kaXNhYmxlIGFpIG1vZGUvaSB9KSkudG9CZUluVGhlRG9jdW1lbnQoKVxuICAgIGV4cGVjdCgoaW5wdXQgYXMgSFRNTFRleHRBcmVhRWxlbWVudCkucGxhY2Vob2xkZXIpLnRvTWF0Y2goL2FzayBhaSBvciB0eXBlIGEgbWVzc2FnZS9pKVxuICB9KVxuXG4gIHRlc3QoJ2lubGluZSBlZGl0OiBvcHRpbWlzdGljIHVwZGF0ZSwgcGVyc2lzdGVuY2UsIGFuZCBXUyBicm9hZGNhc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgcmVuZGVyV2l0aEFjdCg8Q2hhdFdpbmRvdyB7Li4uYmFzZVByb3BzfSAvPilcblxuICAgIC8vIE9yaWdpbmFsIGNvbnRlbnQgdmlzaWJsZVxuICAgIGNvbnN0IG9yaWdpbmFsID0gYXdhaXQgc2NyZWVuLmZpbmRCeVRlc3RJZCgnbXNnLW0xJylcbiAgICBleHBlY3Qob3JpZ2luYWwpLnRvSGF2ZVRleHRDb250ZW50KCdPcmlnaW5hbCBtZXNzYWdlJylcblxuICAgIC8vIFRyaWdnZXIgb3VyIHRlc3Qtb25seSBFZGl0IGJ1dHRvbiBpbiBtb2NrZWQgTWVzc2FnZUJ1YmJsZVxuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdFZGl0JykpXG5cbiAgICAvLyBPcHRpbWlzdGljIGNvbnRlbnQgY2hhbmdlIHNob3VsZCBiZSBpbW1lZGlhdGVcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdtc2ctbTEnKSkudG9IYXZlVGV4dENvbnRlbnQoJ0hlbGxvIGVkaXRlZCcpXG5cbiAgICAvLyBQZXJzaXN0ZW5jZSBhbmQgYnJvYWRjYXN0XG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3QodXBkYXRlTWVzc2FnZU1vY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdtMScsICdIZWxsbyBlZGl0ZWQnKVxuICAgICAgZXhwZWN0KHNlbmRFZGl0TWVzc2FnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ20xJywgJ0hlbGxvIGVkaXRlZCcsICdhYmMnKVxuICAgIH0pXG4gIH0pXG5cbiAgdGVzdCgnaW5saW5lIGVkaXQgZmFpbHVyZTogcmV2ZXJ0cyB0byBwcmV2aW91cyBjb250ZW50JywgYXN5bmMgKCkgPT4ge1xuICAgIHVwZGF0ZU1lc3NhZ2VNb2NrLm1vY2tSZWplY3RlZFZhbHVlT25jZShuZXcgRXJyb3IoJ0RCIGRvd24nKSlcbiAgICBhd2FpdCByZW5kZXJXaXRoQWN0KDxDaGF0V2luZG93IHsuLi5iYXNlUHJvcHN9IC8+KVxuXG4gICAgLy8gT3JpZ2luYWwgY29udGVudCB2aXNpYmxlXG4gICAgZXhwZWN0KGF3YWl0IHNjcmVlbi5maW5kQnlUZXN0SWQoJ21zZy1tMScpKS50b0hhdmVUZXh0Q29udGVudCgnT3JpZ2luYWwgbWVzc2FnZScpXG5cbiAgICAvLyBUcmlnZ2VyIGVkaXRcbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnRWRpdCcpKVxuXG4gICAgLy8gT3B0aW1pc3RpYyBjaGFuZ2UgZmlyc3RcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdtc2ctbTEnKSkudG9IYXZlVGV4dENvbnRlbnQoJ0hlbGxvIGVkaXRlZCcpXG5cbiAgICAvLyBUaGVuIHJldmVydCBhZnRlciBmYWlsdXJlXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdtc2ctbTEnKSkudG9IYXZlVGV4dENvbnRlbnQoJ09yaWdpbmFsIG1lc3NhZ2UnKVxuICAgIH0pXG4gIH0pXG5cbiAgdGVzdCgnc2tlbGV0b24gbG9hZGVyIHNob3dzIHdoaWxlIGxvYWRpbmcsIHRoZW4gZW1wdHkgc3RhdGUgd2hlbiBubyBtZXNzYWdlcycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBEZWxheSBtZXNzYWdlcyB0byBhc3NlcnQgc2tlbGV0b25zXG4gICAgZ2V0TWVzc2FnZXNNb2NrLm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UoKCkgPT4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQoKCkgPT4gcmVzb2x2ZShbXSksIDUwKSkpXG5cbiAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gYXdhaXQgcmVuZGVyV2l0aEFjdCg8Q2hhdFdpbmRvdyB7Li4uYmFzZVByb3BzfSAvPilcblxuICAgIC8vIFNrZWxldG9ucyBwcmVzZW50IGR1cmluZyBsb2FkXG4gICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1zbG90PVwic2tlbGV0b25cIl0nKS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKVxuXG4gICAgLy8gQWZ0ZXIgbG9hZCBjb21wbGV0ZXMsIHNrZWxldG9ucyBnbyBhd2F5IGFuZCBlbXB0eSBzdGF0ZSBzaG93c1xuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1zbG90PVwic2tlbGV0b25cIl0nKS5sZW5ndGgpLnRvQmUoMClcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9ubyBtZXNzYWdlcyB5ZXRcXC4gc2F5IGhlbGxvIS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKVxuICAgIH0pXG4gIH0pXG5cbiAgdGVzdCgnYWN0aW9uIHBhbmVsIG9wZW5zIGFuZCB0YWJzIHN3aXRjaCBvbiBkZXNrdG9wJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IHJlbmRlcldpdGhBY3QoPENoYXRXaW5kb3cgey4uLmJhc2VQcm9wc30gLz4pXG5cbiAgICAvLyBPcGVuIHRoZSBhY3Rpb24gcGFuZWwgdmlhIHRoZSArIGJ1dHRvblxuICAgIGNvbnN0IG9wZW5BY3Rpb25zID0gYXdhaXQgc2NyZWVuLmZpbmRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL29wZW4gYWN0aW9ucy9pIH0pXG4gICAgZmlyZUV2ZW50LmNsaWNrKG9wZW5BY3Rpb25zKVxuXG4gICAgLy8gRGVmYXVsdCB0YWIgaXMgTWVkaWFcbiAgICBleHBlY3QoYXdhaXQgc2NyZWVuLmZpbmRCeVRleHQoL21lZGlhICYgY29udGVudC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKVxuXG4gICAgLy8gU3dpdGNoIHRvIEFwcHNcbiAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvYXBwcy9pIH0pKVxuICAgIGV4cGVjdChhd2FpdCBzY3JlZW4uZmluZEJ5VGV4dCgvcXVpY2sgYXBwcy9pKSkudG9CZUluVGhlRG9jdW1lbnQoKVxuXG4gICAgLy8gU3dpdGNoIHRvIEFnZW50c1xuICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9hZ2VudHMvaSB9KSlcbiAgICBleHBlY3QoYXdhaXQgc2NyZWVuLmZpbmRCeVRleHQoL2FpIGFnZW50cy9pKSkudG9CZUluVGhlRG9jdW1lbnQoKVxuICB9KVxuXG4gIHRlc3QoJ3NlbGVjdGluZyBhIEdJRiBhcHBlbmRzIGEgbmV3IG1lc3NhZ2Ugb24gZGVza3RvcCcsIGFzeW5jICgpID0+IHtcbiAgICBqZXN0LnVzZUZha2VUaW1lcnMoKVxuICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSBhd2FpdCByZW5kZXJXaXRoQWN0KDxDaGF0V2luZG93IHsuLi5iYXNlUHJvcHN9IC8+KVxuXG4gICAgLy8gU3RhcnQgd2l0aCBhIHNpbmdsZSBtZXNzYWdlIGZyb20gdGhlIGJhY2tlbmRcbiAgICBhd2FpdCBzY3JlZW4uZmluZEJ5VGVzdElkKCdtc2ctbTEnKVxuICAgIGV4cGVjdChjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdGVzdGlkXj1cIm1zZy1cIl0nKS5sZW5ndGgpLnRvQmUoMSlcblxuICAgIC8vIE9wZW4gYWN0aW9uIHBhbmVsXG4gICAgZmlyZUV2ZW50LmNsaWNrKGF3YWl0IHNjcmVlbi5maW5kQnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9vcGVuIGFjdGlvbnMvaSB9KSlcbiAgICBleHBlY3QoYXdhaXQgc2NyZWVuLmZpbmRCeVRleHQoL21lZGlhICYgY29udGVudC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKVxuXG4gICAgLy8gT3BlbiBHSUYgcGlja2VyXG4gICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL29wZW4gZ2lmIHBpY2tlci9pIH0pKVxuXG4gICAgLy8gV2FpdCBmb3IgR0lGcyB0byBsb2FkXG4gICAgYXdhaXQgc2NyZWVuLmZpbmRCeVBsYWNlaG9sZGVyVGV4dCgvc2VhcmNoIGdpZnMvaSlcbiAgICBhd2FpdCBzY3JlZW4uZmluZEJ5VGV4dCgvbG9hZGluZyBnaWZzL2kpXG4gICAgYXdhaXQgYWN0KGFzeW5jICgpID0+IHtcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSg2MDApXG4gICAgfSlcblxuICAgIC8vIENsaWNrIGEgR0lGXG4gICAgY29uc3QgZ2lmQnV0dG9uID0gYXdhaXQgc2NyZWVuLmZpbmRCeVRpdGxlKCdIYXBweSBEYW5jZScpXG4gICAgZmlyZUV2ZW50LmNsaWNrKGdpZkJ1dHRvbilcblxuICAgIC8vIE1lc3NhZ2UgY291bnQgc2hvdWxkIGluY3JlYXNlXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3QoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRlc3RpZF49XCJtc2ctXCJdJykubGVuZ3RoKS50b0JlKDIpXG4gICAgfSlcblxuICAgIGplc3QudXNlUmVhbFRpbWVycygpXG4gIH0pXG59KVxuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwicHJvcHMiLCJ1c2VSb3V0ZXIiLCJwdXNoIiwiZm4iLCJyZXBsYWNlIiwicHJlZmV0Y2giLCJiYWNrIiwidXNlUGF0aG5hbWUiLCJ1c2VTZWFyY2hQYXJhbXMiLCJnZXQiLCJDUkVESVRTX0VOQUJMRUQiLCJDUkVESVRTX1BFUl9BSV9SRVFVRVNUIiwiZ2V0Q3JlZGl0QmFsYW5jZSIsImJhbGFuY2UiLCJ1c2VDb252ZXJzYXRpb25zIiwiY29udmVyc2F0aW9ucyIsImlkIiwidGl0bGUiLCJjcmVhdGVkX2F0IiwidXBkYXRlZF9hdCIsInVzZXJfaWQiLCJsb2FkaW5nIiwiZXJyb3IiLCJpbnZpdGVQYXJ0aWNpcGFudHMiLCJ1c2VJc01vYmlsZSIsIm1vY2tVc2VJc01vYmlsZSIsInVzZVdlYlNvY2tldCIsImlzQ29ubmVjdGVkIiwibWVzc2FnZXMiLCJ0eXBpbmdVc2VycyIsImpvaW5Db252ZXJzYXRpb24iLCJzZW5kQ2hhdE1lc3NhZ2UiLCJzZW5kVHlwaW5nIiwic2VuZEVkaXRNZXNzYWdlIiwic3VwYWJhc2UiLCJhdXRoIiwiZ2V0VXNlciIsImRhdGEiLCJ1c2VyIiwiZnJvbSIsIl90YWJsZSIsInNlbGVjdCIsIl9zZWwiLCJfb3B0cyIsImVxIiwiX2NvbCIsIl92YWwiLCJQcm9taXNlIiwicmVzb2x2ZSIsImNvdW50IiwiTWVzc2FnZUJ1YmJsZSIsIm1lc3NhZ2UiLCJvblVwZGF0ZU1lc3NhZ2UiLCJkaXYiLCJkYXRhLXRlc3RpZCIsImNvbnRlbnQiLCJidXR0b24iLCJvbkNsaWNrIiwibWVzc2FnZVNlcnZpY2UiLCJnZXRNZXNzYWdlcyIsImFyZ3MiLCJnZXRNZXNzYWdlc01vY2siLCJ1cGRhdGVNZXNzYWdlIiwidXBkYXRlTWVzc2FnZU1vY2siLCJiYXNlUHJvcHMiLCJjaGF0SWQiLCJvblRvZ2dsZVNpZGViYXIiLCJzaWRlYmFyQ29sbGFwc2VkIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmV0dXJuVmFsdWUiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImNvbnZlcnNhdGlvbl9pZCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInJvbGUiLCJ0eXBlIiwiZWRpdGVkX2F0IiwiZGVzY3JpYmUiLCJ0ZXN0IiwicmVuZGVyV2l0aEFjdCIsIkNoYXRXaW5kb3ciLCJleHBlY3QiLCJzY3JlZW4iLCJmaW5kQnlMYWJlbFRleHQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsIndhaXRGb3IiLCJxdWVyeUJ5TGFiZWxUZXh0Iiwibm90IiwiaW5wdXQiLCJmaXJlRXZlbnQiLCJjaGFuZ2UiLCJ0YXJnZXQiLCJ2YWx1ZSIsImtleURvd24iLCJrZXkiLCJjb2RlIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwic2hpZnRLZXkiLCJjdHJsS2V5IiwiZmluZEJ5VGV4dCIsImdldEJ5Um9sZSIsIm5hbWUiLCJnZXRCeVRlc3RJZCIsInBsYWNlaG9sZGVyIiwidG9NYXRjaCIsInRvZ2dsZSIsImNsaWNrIiwiZ2V0QnlUZXh0Iiwib3JpZ2luYWwiLCJmaW5kQnlUZXN0SWQiLCJ0b0hhdmVUZXh0Q29udGVudCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwibW9ja1JlamVjdGVkVmFsdWVPbmNlIiwiRXJyb3IiLCJtb2NrSW1wbGVtZW50YXRpb25PbmNlIiwic2V0VGltZW91dCIsImNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJ0b0JlR3JlYXRlclRoYW4iLCJ0b0JlIiwib3BlbkFjdGlvbnMiLCJmaW5kQnlSb2xlIiwidXNlRmFrZVRpbWVycyIsImZpbmRCeVBsYWNlaG9sZGVyVGV4dCIsImFjdCIsImFkdmFuY2VUaW1lcnNCeVRpbWUiLCJnaWZCdXR0b24iLCJmaW5kQnlUaXRsZSIsInVzZVJlYWxUaW1lcnMiXSwibWFwcGluZ3MiOiI7QUFJQSxtRUFBbUU7QUFDbkVBLEtBQUtDLElBQUksQ0FBQyxnQkFBZ0IsSUFBTSxJQUFNLENBQUNDLFFBQWU7QUFFdEQsZ0ZBQWdGO0FBQ2hGRixLQUFLQyxJQUFJLENBQUMsbUJBQW1CLElBQU8sQ0FBQTtRQUNsQ0UsV0FBVyxJQUFPLENBQUE7Z0JBQUVDLE1BQU1KLEtBQUtLLEVBQUU7Z0JBQUlDLFNBQVNOLEtBQUtLLEVBQUU7Z0JBQUlFLFVBQVVQLEtBQUtLLEVB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