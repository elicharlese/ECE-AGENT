{"version":3,"sources":["/Users/elicharlese/CascadeProjects/ECE-AGENT/__tests__/hooks/use-websocket.test.ts"],"sourcesContent":["import { renderHook, act, waitFor } from '@testing-library/react';\nimport { useWebSocket } from '@/hooks/use-websocket';\n\n// Mock the Supabase client\njest.mock('@/lib/supabase/client', () => ({\n  supabase: {\n    auth: {\n      getSession: jest.fn().mockResolvedValue({\n        data: {\n          session: {\n            access_token: 'test-token'\n          }\n        },\n        error: null\n      })\n    }\n  }\n}));\n\ndescribe('useWebSocket', () => {\n  const originalWSUrl = process.env.NEXT_PUBLIC_WEBSOCKET_URL;\n  beforeEach(() => {\n    jest.clearAllMocks();\n    // Force hook into mock-connect path for tests\n    delete process.env.NEXT_PUBLIC_WEBSOCKET_URL;\n  });\n\n  afterAll(() => {\n    if (originalWSUrl !== undefined) {\n      process.env.NEXT_PUBLIC_WEBSOCKET_URL = originalWSUrl;\n    }\n  });\n\n  it('should have connect, sendChatMessage, joinConversation, and leaveConversation functions', async () => {\n    const { result } = renderHook(() => useWebSocket());\n    \n    expect(result.current.connect).toBeDefined();\n    expect(result.current.sendChatMessage).toBeDefined();\n    expect(result.current.joinConversation).toBeDefined();\n    expect(result.current.leaveConversation).toBeDefined();\n    // Hook establishes a mock connection on mount\n    await waitFor(() => expect(result.current.isConnected).toBe(true));\n    expect(result.current.messages).toEqual([]);\n  });\n});\n"],"names":["jest","mock","supabase","auth","getSession","fn","mockResolvedValue","data","session","access_token","error","describe","originalWSUrl","process","env","NEXT_PUBLIC_WEBSOCKET_URL","beforeEach","clearAllMocks","afterAll","undefined","it","result","renderHook","useWebSocket","expect","current","connect","toBeDefined","sendChatMessage","joinConversation","leaveConversation","waitFor","isConnected","toBe","messages","toEqual"],"mappings":";AAGA,2BAA2B;AAC3BA,KAAKC,IAAI,CAAC,yBAAyB,IAAO,CAAA;QACxCC,UAAU;YACRC,MAAM;gBACJC,YAAYJ,KAAKK,EAAE,GAAGC,iBAAiB,CAAC;oBACtCC,MAAM;wBACJC,SAAS;4BACPC,cAAc;wBAChB;oBACF;oBACAC,OAAO;gBACT;YACF;QACF;IACF,CAAA;;;;uBAjByC;8BACZ;AAkB7BC,SAAS,gBAAgB;IACvB,MAAMC,gBAAgBC,QAAQC,GAAG,CAACC,yBAAyB;IAC3DC,WAAW;QACThB,KAAKiB,aAAa;QAClB,8CAA8C;QAC9C,OAAOJ,QAAQC,GAAG,CAACC,yBAAyB;IAC9C;IAEAG,SAAS;QACP,IAAIN,kBAAkBO,WAAW;YAC/BN,QAAQC,GAAG,CAACC,yBAAyB,GAAGH;QAC1C;IACF;IAEAQ,GAAG,2FAA2F;QAC5F,MAAM,EAAEC,MAAM,EAAE,GAAGC,IAAAA,iBAAU,EAAC,IAAMC,IAAAA,0BAAY;QAEhDC,OAAOH,OAAOI,OAAO,CAACC,OAAO,EAAEC,WAAW;QAC1CH,OAAOH,OAAOI,OAAO,CAACG,eAAe,EAAED,WAAW;QAClDH,OAAOH,OAAOI,OAAO,CAACI,gBAAgB,EAAEF,WAAW;QACnDH,OAAOH,OAAOI,OAAO,CAACK,iBAAiB,EAAEH,WAAW;QACpD,8CAA8C;QAC9C,MAAMI,IAAAA,cAAO,EAAC,IAAMP,OAAOH,OAAOI,OAAO,CAACO,WAAW,EAAEC,IAAI,CAAC;QAC5DT,OAAOH,OAAOI,OAAO,CAACS,QAAQ,EAAEC,OAAO,CAAC,EAAE;IAC5C;AACF"}