{"version":3,"sources":["/Users/elicharlese/CascadeProjects/ECE-AGENT/components/chat/message-bubble.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { MediaPreview } from \"./media-preview\"\nimport { MessageActions } from \"./message-actions\"\nimport { SwipeActions } from \"./swipe-actions\"\nimport { Button } from \"@/components/ui/button\"\nimport { Download, FileText, Pin, Heart, ImageIcon } from \"lucide-react\"\nimport { useHaptics } from \"@/hooks/use-haptics\"\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { MessageReactions } from \"./message-reactions\"\n\ninterface Message {\n  id: string\n  content: string\n  timestamp: Date\n  senderId: string\n  senderName: string\n  type: \"text\" | \"image\" | \"video\" | \"audio\" | \"document\" | \"system\" | \"gif\" | \"app\"\n  isOwn: boolean\n  mediaUrl?: string\n  fileName?: string\n  fileSize?: string\n  isPinned?: boolean\n  isLiked?: boolean\n  likeCount?: number\n  reactions?: Array<{\n    emoji: string\n    count: number\n    users: string[]\n    hasReacted: boolean\n  }>\n  gifData?: {\n    id: string\n    title: string\n    url: string\n    preview_url: string\n    width: number\n    height: number\n  }\n}\n\ninterface MessageBubbleProps {\n  message: Message\n}\n\nexport function MessageBubble({ message }: MessageBubbleProps) {\n  const [isPinned, setIsPinned] = useState(message.isPinned || false)\n  const [isLiked, setIsLiked] = useState(message.isLiked || false)\n  const [likeCount, setLikeCount] = useState(message.likeCount || 0)\n  const [reactions, setReactions] = useState(message.reactions || [])\n  const [showReactionPicker, setShowReactionPicker] = useState(false)\n  const { triggerHaptic } = useHaptics()\n  const isMobile = useIsMobile()\n\n  const formatTime = (date: Date) => {\n    return date.toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" })\n  }\n\n  const handlePin = (messageId: string) => {\n    setIsPinned(true)\n    triggerHaptic(\"medium\")\n    console.log(\"Pinning message:\", messageId)\n  }\n\n  const handleUnpin = (messageId: string) => {\n    setIsPinned(false)\n    triggerHaptic(\"light\")\n    console.log(\"Unpinning message:\", messageId)\n  }\n\n  const handleLike = (messageId: string) => {\n    setIsLiked(true)\n    setLikeCount((prev) => prev + 1)\n    triggerHaptic(\"light\")\n    console.log(\"Liking message:\", messageId)\n  }\n\n  const handleUnlike = (messageId: string) => {\n    setIsLiked(false)\n    setLikeCount((prev) => Math.max(0, prev - 1))\n    triggerHaptic(\"selection\")\n    console.log(\"Unliking message:\", messageId)\n  }\n\n  const handleReply = (messageId: string) => {\n    triggerHaptic(\"medium\")\n    console.log(\"Replying to message:\", messageId)\n  }\n\n  const handleForward = (messageId: string) => {\n    triggerHaptic(\"medium\")\n    console.log(\"Forwarding message:\", messageId)\n  }\n\n  const handleCopy = (messageId: string) => {\n    navigator.clipboard.writeText(message.content)\n    triggerHaptic(\"light\")\n    console.log(\"Copied message:\", messageId)\n  }\n\n  const handleDelete = (messageId: string) => {\n    triggerHaptic(\"heavy\")\n    console.log(\"Deleting message:\", messageId)\n  }\n\n  const handleAddReaction = (messageId: string, emoji: string) => {\n    setReactions((prev) => {\n      const existingReaction = prev.find((r) => r.emoji === emoji)\n      if (existingReaction) {\n        return prev.map((r) => (r.emoji === emoji ? { ...r, count: r.count + 1, hasReacted: true } : r))\n      } else {\n        return [...prev, { emoji, count: 1, users: [\"current-user\"], hasReacted: true }]\n      }\n    })\n    console.log(\"Adding reaction:\", emoji, \"to message:\", messageId)\n  }\n\n  const handleRemoveReaction = (messageId: string, emoji: string) => {\n    setReactions((prev) => {\n      return prev\n        .map((r) => (r.emoji === emoji ? { ...r, count: Math.max(0, r.count - 1), hasReacted: false } : r))\n        .filter((r) => r.count > 0)\n    })\n    console.log(\"Removing reaction:\", emoji, \"from message:\", messageId)\n  }\n\n  const handleLongPress = () => {\n    if (isMobile) {\n      setShowReactionPicker(true)\n      triggerHaptic(\"medium\")\n    }\n  }\n\n  const handleDoubleClick = () => {\n    if (!isMobile) {\n      // Quick reaction with heart\n      handleAddReaction(message.id, \"❤️\")\n    }\n  }\n\n  if (message.type === \"system\") {\n    return (\n      <div className=\"flex justify-center\">\n        <span className=\"text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full\">\n          {message.content}\n        </span>\n      </div>\n    )\n  }\n\n  const renderMessageContent = () => {\n    switch (message.type) {\n      case \"image\":\n        return (\n          <div className=\"max-w-xs\">\n            <MediaPreview\n              src={message.mediaUrl || \"/placeholder.svg?height=200&width=300\"}\n              type=\"image\"\n              alt={message.content}\n              className=\"w-full h-48\"\n            />\n            {message.content && <p className=\"mt-2 text-sm\">{message.content}</p>}\n          </div>\n        )\n\n      case \"video\":\n        return (\n          <div className=\"max-w-sm\">\n            <MediaPreview\n              src={message.mediaUrl || \"/placeholder.svg?height=200&width=300\"}\n              type=\"video\"\n              className=\"w-full h-48\"\n            />\n            {message.content && <p className=\"mt-2 text-sm\">{message.content}</p>}\n          </div>\n        )\n\n      case \"audio\":\n        return (\n          <div className=\"max-w-xs\">\n            <MediaPreview src={message.mediaUrl || \"\"} type=\"audio\" className=\"w-full\" />\n            {message.content && <p className=\"mt-2 text-sm\">{message.content}</p>}\n          </div>\n        )\n\n      case \"document\":\n        return (\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 max-w-xs\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"bg-blue-500 rounded-lg p-2\">\n                <FileText className=\"h-4 w-4 text-white\" />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium truncate\">{message.fileName || \"Document\"}</p>\n                <p className=\"text-xs text-gray-500 dark:text-gray-400\">{message.fileSize || \"Unknown size\"}</p>\n              </div>\n              <Button variant=\"ghost\" size=\"sm\">\n                <Download className=\"h-4 w-4\" />\n              </Button>\n            </div>\n            {message.content && <p className=\"mt-2 text-sm\">{message.content}</p>}\n          </div>\n        )\n\n      case \"gif\":\n        return (\n          <div className=\"max-w-xs\">\n            <div className=\"relative rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800\">\n              <img\n                src={message.gifData?.url || message.mediaUrl || \"/placeholder.svg?height=200&width=300\"}\n                alt={message.gifData?.title || message.content || \"GIF\"}\n                className=\"w-full h-auto max-h-64 object-cover\"\n                loading=\"lazy\"\n              />\n              {/* GIF indicator */}\n              <div className=\"absolute top-2 left-2\">\n                <Badge variant=\"secondary\" className=\"text-xs px-2 py-1 bg-black/70 text-white border-0\">\n                  <ImageIcon className=\"h-3 w-3 mr-1\" />\n                  GIF\n                </Badge>\n              </div>\n              {/* GIF title overlay */}\n              {message.gifData?.title && (\n                <div className=\"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2\">\n                  <p className=\"text-white text-xs font-medium truncate\">{message.gifData.title}</p>\n                </div>\n              )}\n            </div>\n            {message.content && message.content !== message.gifData?.title && (\n              <p className=\"mt-2 text-sm\">{message.content}</p>\n            )}\n          </div>\n        )\n\n      default:\n        return <span>{message.content}</span>\n    }\n  }\n\n  const messageContent = (\n    <div className={`flex gap-2 group ${message.isOwn ? \"justify-end\" : \"justify-start\"}`}>\n      {!message.isOwn && (\n        <Avatar className={`${isMobile ? \"h-8 w-8\" : \"h-6 w-6\"} mt-1`}>\n          <AvatarImage />\n          <AvatarFallback className=\"bg-gradient-to-br from-blue-500 to-purple-600 text-white text-xs\">\n            {message.senderName\n              .split(\" \")\n              .map((n) => n[0])\n              .join(\"\")}\n          </AvatarFallback>\n        </Avatar>\n      )}\n\n      <div className={`max-w-xs lg:max-w-md ${message.isOwn ? \"order-1\" : \"\"}`}>\n        {/* Message indicators */}\n        <div className={`flex items-center gap-1 mb-1 ${message.isOwn ? \"justify-end\" : \"justify-start\"}`}>\n          {isPinned && (\n            <Badge variant=\"secondary\" className=\"text-xs px-1 py-0\">\n              <Pin className=\"h-2 w-2 mr-1\" />\n              Pinned\n            </Badge>\n          )}\n        </div>\n\n        <div className=\"relative\">\n          {/* MessageReactions moved above the message content */}\n          <MessageReactions\n            messageId={message.id}\n            reactions={reactions}\n            onAddReaction={handleAddReaction}\n            onRemoveReaction={handleRemoveReaction}\n            showPicker={showReactionPicker}\n            onTogglePicker={() => setShowReactionPicker(false)}\n          />\n\n          <div\n            className={`\n            ${message.type === \"text\" ? `${isMobile ? \"px-3 py-2\" : \"px-4 py-2\"}` : \"p-1\"} rounded-2xl text-sm\n            ${\n              message.isOwn\n                ? `${message.type === \"text\" ? \"bg-blue-500 text-white\" : \"bg-blue-50 dark:bg-blue-900/20\"} rounded-br-md`\n                : `${message.type === \"text\" ? \"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white\" : \"bg-white dark:bg-gray-800\"} rounded-bl-md`\n            }\n          `}\n            onTouchStart={handleLongPress}\n            onDoubleClick={handleDoubleClick}\n            onContextMenu={(e) => {\n              e.preventDefault()\n              setShowReactionPicker(true)\n            }}\n          >\n            {renderMessageContent()}\n          </div>\n\n          {!isMobile && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className={`absolute top-1 ${message.isOwn ? \"-left-10\" : \"-right-10\"} opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 p-0 rounded-full`}\n              onClick={() => setShowReactionPicker(!showReactionPicker)}\n            >\n              <span className=\"text-sm\">😊</span>\n            </Button>\n          )}\n\n          {/* Message Actions - Hidden on mobile, shown via swipe */}\n          {!isMobile && (\n            <div className={`absolute top-1 ${message.isOwn ? \"-left-8\" : \"-right-8\"}`}>\n              <MessageActions\n                messageId={message.id}\n                isPinned={isPinned}\n                isLiked={isLiked}\n                onPin={handlePin}\n                onUnpin={handleUnpin}\n                onLike={handleLike}\n                onUnlike={handleUnlike}\n                onReply={handleReply}\n                onForward={handleForward}\n                onCopy={handleCopy}\n                onDelete={handleDelete}\n              />\n            </div>\n          )}\n        </div>\n\n        {/* Message footer */}\n        <div className={`flex items-center gap-2 mt-1 ${message.isOwn ? \"justify-end\" : \"justify-start\"}`}>\n          <span className=\"text-xs text-gray-500 dark:text-gray-400\">{formatTime(message.timestamp)}</span>\n          {likeCount > 0 && (\n            <div className=\"flex items-center gap-1\">\n              <Heart className=\"h-3 w-3 text-red-500 fill-current\" />\n              <span className=\"text-xs text-gray-500 dark:text-gray-400\">{likeCount}</span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n\n  // Wrap with swipe actions on mobile\n  if (isMobile) {\n    return (\n      <SwipeActions\n        onReply={() => handleReply(message.id)}\n        onPin={isPinned ? () => handleUnpin(message.id) : () => handlePin(message.id)}\n        onLike={isLiked ? () => handleUnlike(message.id) : () => handleLike(message.id)}\n        onDelete={() => handleDelete(message.id)}\n      >\n        {messageContent}\n      </SwipeActions>\n    )\n  }\n\n  return messageContent\n}\n"],"names":["MessageBubble","message","isPinned","setIsPinned","useState","isLiked","setIsLiked","likeCount","setLikeCount","reactions","setReactions","showReactionPicker","setShowReactionPicker","triggerHaptic","useHaptics","isMobile","useIsMobile","formatTime","date","toLocaleTimeString","hour","minute","handlePin","messageId","console","log","handleUnpin","handleLike","prev","handleUnlike","Math","max","handleReply","handleForward","handleCopy","navigator","clipboard","writeText","content","handleDelete","handleAddReaction","emoji","existingReaction","find","r","map","count","hasReacted","users","handleRemoveReaction","filter","handleLongPress","handleDoubleClick","id","type","div","className","span","renderMessageContent","MediaPreview","src","mediaUrl","alt","p","FileText","fileName","fileSize","Button","variant","size","Download","img","gifData","url","title","loading","Badge","ImageIcon","messageContent","isOwn","Avatar","AvatarImage","AvatarFallback","senderName","split","n","join","Pin","MessageReactions","onAddReaction","onRemoveReaction","showPicker","onTogglePicker","onTouchStart","onDoubleClick","onContextMenu","e","preventDefault","onClick","MessageActions","onPin","onUnpin","onLike","onUnlike","onReply","onForward","onCopy","onDelete","timestamp","Heart","SwipeActions"],"mappings":"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"}